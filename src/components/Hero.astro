---
export const fitText = `
  const fit = () => {
    const container = document.getElementById('fit-container');
    const text = document.getElementById('fit-text');
    if (!container || !text) return;

    // Reset styles
    text.style.transform = 'none';
    text.style.fontSize = '10px';
    text.style.whiteSpace = 'nowrap';
    text.style.display = 'inline-block';
    text.style.transformOrigin = 'left bottom';

    // Ensure the text becomes wider than the container, then scale it down
    const base = container.clientWidth || window.innerWidth || 1000;
    text.style.fontSize = base + 'px';

    const textWidth = text.scrollWidth || text.offsetWidth;
    if (!textWidth) return;
    const scale = (container.clientWidth - 1) / textWidth;
    text.style.transform = \`scale(\${scale})\`;
  };

  const initFit = () => {
    fit();
    const container = document.getElementById('fit-container');
    if (container && 'ResizeObserver' in window) {
      new ResizeObserver(fit).observe(container);
    }
    // Añadimos también un listener para el evento resize como respaldo
    window.addEventListener('resize', fit);
  };

  if (document.readyState !== 'loading') {
    initFit();
  } else {
    document.addEventListener('DOMContentLoaded', initFit);
  }
`;
---

<section class="h-screen w-screen flex items-end bg-background relative overflow-hidden">
  <div class="w-full p-4 pb-6 relative z-10">
    <div id="fit-container" class="w-full overflow-hidden">
      <h1 id="fit-text" class="inline-block font-extrabold leading-none drop-shadow-lg bg-gradient-to-r from-text via-primary to-text bg-clip-text text-transparent font-modamode tracking-tight select-none">
        GABRIEL ALMARCHA
      </h1>
    </div>
  </div>
</section>

<script set:html={fitText}></script>
